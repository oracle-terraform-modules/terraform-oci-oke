= Quickstart

:idprefix:
:idseparator: -
:sectlinks:


:uri-repo: https://github.com/oracle-terraform-modules/terraform-oci-oke
:uri-rel-file-base: link:{uri-repo}/blob/master
:uri-rel-tree-base: link:{uri-repo}/tree/master
:uri-docs: {uri-rel-file-base}/docs
:uri-instructions: {uri-docs}/instructions.adoc
:uri-oci-keys: https://docs.cloud.oracle.com/iaas/Content/API/Concepts/apisigningkey.htm
:uri-oci-ocids: https://docs.cloud.oracle.com/iaas/Content/API/Concepts/apisigningkey.htm#five
:uri-oci-okepolicy: https://docs.cloud.oracle.com/iaas/Content/ContEng/Concepts/contengpolicyconfig.htm#PolicyPrerequisitesService
:uri-terraform: https://www.terraform.io
:uri-terraform-oci: https://www.terraform.io/docs/providers/oci/index.html
:uri-terraform-options: {uri-docs}/terraformoptions.adoc
:uri-topology: {uri-docs}/topology.adoc
:uri-variables: {uri-rel-file-base}/variables.tf

. link:#assumptions[Assumptions]
. link:#pre-requisites[Pre-requisites]
. link:#instructions[Instructions]
. link:#related-documentation[Related documentation]

=== Assumptions

1. You have setup the {uri-oci-keys}[required keys]
2. You know the {uri-oci-ocids}[required OCIDs]
3. You have set the {uri-oci-okepolicy}[necessary OKE policy]
4. You have created the required VCN and other components using https://github.com/oracle-terraform-modules/terraform-oci-base

=== Pre-requisites

1. git is installed
2. ssh client is installed
3. Terraform 0.12.16+ is installed

=== Provisioning using this git repo

. Clone the repo:

+
[source,bash]
----
git clone -b reuse-vcn https://github.com/oracle-terraform-modules/terraform-oci-oke.git tfoke

cd tfoke
cp terraform.tfvars.example terraform.tfvars
----

. Create a provider.tf file and add the following:

+
----
provider "oci" {
  tenancy_ocid         = var.tenancy_id
  user_ocid            = var.user_id
  fingerprint          = var.api_fingerprint
  private_key_path     = var.api_private_key_path
  region               = var.region
  disable_auto_retries = var.disable_auto_retries
}
----

. Set mandatory parameters:

* api_fingerprint
* api_private_key_path
* compartment_id
* compartment_name
* tenancy_id
* user_id

. Reuse VCN mandatory parameters

* reuse
* vcn_id
* bastion_public_ip
* operator_private_ip
* ig_route_id
* nat_route_id
* dynamicgroup_name

. Override other parameters:

* region

. Optional parameters to override:
* cluster_name
* ssh_private_key_path (Required if bastion is enabled)
* ssh_public_key_path (Required if bastion is enabled)
* worker_mode
* worker_dnslabel
* lb_dnslabel

. Run Terraform:

+
[source,bash]
----
terraform init
terraform plan
terraform apply
----

=== Provisioning using the Hashicorp registry module

. In your project root, create a provider.tf file and add the following:

+
----
provider "oci" {
  tenancy_ocid         = var.tenancy_id
  user_ocid            = var.user_id
  fingerprint          = var.api_fingerprint
  private_key_path     = var.api_private_key_path
  region               = var.region
  disable_auto_retries = var.disable_auto_retries
}
----

. In your project root, create a variables.tf file and add variables for your project. You can copy the existing {uri-variables}[variables.tf] in the oke module root.

. Run Terraform:

+
[source,bash]
----
terraform init
terraform plan
terraform apply
----

=== Related documentation:

* {uri-instructions}[Detailed Instructions]

* {uri-terraform-options}[All Terraform configuration options] for {uri-repo}[this project]
